/*
 * bootstrap-tagsinput v0.6.1 by Tim Schlechter
 * 
 */
!function(a){"use strict";function c(b,c){this.itemsArray=[],this.$element=a(b),this.$element.hide(),this.isSelect="SELECT"===b.tagName,this.multiple=this.isSelect&&b.hasAttribute("multiple"),this.objectItems=c&&c.itemValue,this.placeholderText=b.hasAttribute("placeholder")?this.$element.attr("placeholder"):"",this.inputSize=Math.max(1,this.placeholderText.length),this.inputClass=b.hasAttribute("class")?this.$element.attr("class"):"form-control",this.$container=a('<div class="bootstrap-tagsinput '+this.inputClass+'"></div>'),this.$input=a('<input type="text" placeholder="'+this.placeholderText+'"/>').appendTo(this.$container),this.$element.before(this.$container),this.build(c)}function d(a,b){if("function"!=typeof a[b]){var c=a[b];a[b]=function(a){return a[c]}}}function e(a,b){if("function"!=typeof a[b]){var c=a[b];a[b]=function(){return c}}}function g(a){return a?f.text(a).html():""}function h(a){var c,b=0;return document.selection?(a.focus(),c=document.selection.createRange(),c.moveStart("character",-a.value.length),b=c.text.length):(a.selectionStart||"0"==a.selectionStart)&&(b=a.selectionStart),b}function i(b,c){var d=!1;return a.each(c,function(a,c){if("number"==typeof c&&b.which===c)return d=!0,!1;if(b.which===c.which){var e=!c.hasOwnProperty("altKey")||b.altKey===c.altKey,f=!c.hasOwnProperty("shiftKey")||b.shiftKey===c.shiftKey,g=!c.hasOwnProperty("ctrlKey")||b.ctrlKey===c.ctrlKey;if(e&&f&&g)return d=!0,!1}}),d}var f,b={tagClass:function(){return"badge text-bg-primary"},itemValue:function(a){return a?a.toString():a},itemText:function(a){return this.itemValue(a)},itemTitle:function(){return null},freeInput:!0,addOnBlur:!0,maxTags:void 0,maxChars:void 0,confirmKeys:[13,44],delimiter:",",delimiterRegex:null,cancelConfirmKeysOnEmpty:!1,onTagExists:function(a,b){b.hide().fadeIn()},trimValue:!0,allowDuplicates:!1};c.prototype={constructor:c,add:function(b,c,d){var f,h,i,j,k,l,m,n,o,p,q,r,e=this;if(!(e.options.maxTags&&e.itemsArray.length>=e.options.maxTags||b!==!1&&!b)){if("string"==typeof b&&e.options.trimValue&&(b=a.trim(b)),"object"==typeof b&&!e.objectItems)throw"Can't add objects when itemValue option is not set";if(!b.toString().match(/^\s*$/)){if(e.isSelect&&!e.multiple&&e.itemsArray.length>0&&e.remove(e.itemsArray[0]),"string"==typeof b&&"INPUT"===this.$element[0].tagName&&(f=e.options.delimiterRegex?e.options.delimiterRegex:e.options.delimiter,h=b.split(f),h.length>1)){for(i=0;i<h.length;i++)this.add(h[i],!0);return c||e.pushVal(),void 0}return j=e.options.itemValue(b),k=e.options.itemText(b),l=e.options.tagClass(b),m=e.options.itemTitle(b),n=a.grep(e.itemsArray,function(a){return e.options.itemValue(a)===j})[0],n&&!e.options.allowDuplicates?(e.options.onTagExists&&(o=a(".tag",e.$container).filter(function(){return a(this).data("item")===n}),e.options.onTagExists(b,o)),void 0):(e.items().toString().length+b.length+1>e.options.maxInputLength||(p=a.Event("beforeItemAdd",{item:b,cancel:!1,options:d}),e.$element.trigger(p),p.cancel||(e.itemsArray.push(b),q=a('<span class="tag '+g(l)+(null!==m?'" title="'+m:"")+'">'+g(k)+'<span data-role="remove"></span></span>'),q.data("item",b),e.findInputWrapper().before(q),q.after(" "),e.isSelect&&!a('option[value="'+encodeURIComponent(j)+'"]',e.$element)[0]&&(r=a("<option selected>"+g(k)+"</option>"),r.data("item",b),r.attr("value",j),e.$element.append(r)),c||e.pushVal(),(e.options.maxTags===e.itemsArray.length||e.items().toString().length===e.options.maxInputLength)&&e.$container.addClass("bootstrap-tagsinput-max"),e.$element.trigger(a.Event("itemAdded",{item:b,options:d})))),void 0)}}},remove:function(b,c,d){var f,e=this;if(e.objectItems&&(b="object"==typeof b?a.grep(e.itemsArray,function(a){return e.options.itemValue(a)==e.options.itemValue(b)}):a.grep(e.itemsArray,function(a){return e.options.itemValue(a)==b}),b=b[b.length-1]),b){if(f=a.Event("beforeItemRemove",{item:b,cancel:!1,options:d}),e.$element.trigger(f),f.cancel)return;a(".tag",e.$container).filter(function(){return a(this).data("item")===b}).remove(),a("option",e.$element).filter(function(){return a(this).data("item")===b}).remove(),-1!==a.inArray(b,e.itemsArray)&&e.itemsArray.splice(a.inArray(b,e.itemsArray),1)}c||e.pushVal(),e.options.maxTags>e.itemsArray.length&&e.$container.removeClass("bootstrap-tagsinput-max"),e.$element.trigger(a.Event("itemRemoved",{item:b,options:d}))},removeAll:function(){var b=this;for(a(".tag",b.$container).remove(),a("option",b.$element).remove();b.itemsArray.length>0;)b.itemsArray.pop();b.pushVal()},refresh:function(){var b=this;a(".tag",b.$container).each(function(){var i,c=a(this),d=c.data("item"),e=b.options.itemValue(d),f=b.options.itemText(d),h=b.options.tagClass(d);c.attr("class",null),c.addClass("tag "+g(h)),c.contents().filter(function(){return 3==this.nodeType})[0].nodeValue=g(f),b.isSelect&&(i=a("option",b.$element).filter(function(){return a(this).data("item")===d}),i.attr("value",e))})},items:function(){return this.itemsArray},pushVal:function(){var b=this,c=a.map(b.items(),function(a){return b.options.itemValue(a).toString()});b.$element.val(c,!0).trigger("change")},build:function(c){var g,j,k,l,f=this;f.options=a.extend({},b,c),f.objectItems&&(f.options.freeInput=!1),d(f.options,"itemValue"),d(f.options,"itemText"),e(f.options,"tagClass"),f.options.typeahead&&(g=f.options.typeahead||{},e(g,"source"),f.$input.typeahead(a.extend({},g,{source:function(b,c){function d(a){var d,g,b=[];for(d=0;d<a.length;d++)g=f.options.itemText(a[d]),e[g]=a[d],b.push(g);c(b)}this.map={};var e=this.map,h=g.source(b);a.isFunction(h.success)?h.success(d):a.isFunction(h.then)?h.then(d):a.when(h).then(d)},updater:function(a){return f.add(this.map[a]),this.map[a]},matcher:function(a){return-1!==a.toLowerCase().indexOf(this.query.trim().toLowerCase())},sorter:function(a){return a.sort()},highlighter:function(a){var b=new RegExp("("+this.query+")","gi");return a.replace(b,"<strong>$1</strong>")}}))),f.options.typeaheadjs&&(j=null,k={},l=f.options.typeaheadjs,a.isArray(l)?(j=l[0],k=l[1]):k=l,f.$input.typeahead(j,k).on("typeahead:selected",a.proxy(function(a,b){k.valueKey?f.add(b[k.valueKey]):f.add(b),f.$input.typeahead("val","")},f))),f.$container.on("click",a.proxy(function(){f.$element.attr("disabled")||f.$input.removeAttr("disabled"),f.$input.focus()},f)),f.options.addOnBlur&&f.options.freeInput&&f.$input.on("focusout",a.proxy(function(){0===a(".typeahead, .twitter-typeahead",f.$container).length&&(f.add(f.$input.val()),f.$input.val(""))},f)),f.$container.on("keydown","input",a.proxy(function(b){var e,g,i,j,k,c=a(b.target),d=f.findInputWrapper();if(f.$element.attr("disabled"))return f.$input.attr("disabled","disabled"),void 0;switch(b.which){case 8:0===h(c[0])&&(e=d.prev(),e.length&&f.remove(e.data("item")));break;case 46:0===h(c[0])&&(g=d.next(),g.length&&f.remove(g.data("item")));break;case 37:i=d.prev(),0===c.val().length&&i[0]&&(i.before(d),c.focus());break;case 39:j=d.next(),0===c.val().length&&j[0]&&(j.after(d),c.focus())}k=c.val().length,Math.ceil(k/5),c.attr("size",Math.max(this.inputSize,c.val().length))},f)),f.$container.on("keypress","input",a.proxy(function(b){var d,e,g,c=a(b.target);return f.$element.attr("disabled")?(f.$input.attr("disabled","disabled"),void 0):(d=c.val(),e=f.options.maxChars&&d.length>=f.options.maxChars,f.options.freeInput&&(i(b,f.options.confirmKeys)||e)&&(0!==d.length&&(f.add(e?d.substr(0,f.options.maxChars):d),c.val("")),f.options.cancelConfirmKeysOnEmpty===!1&&b.preventDefault()),g=c.val().length,Math.ceil(g/5),c.attr("size",Math.max(this.inputSize,c.val().length)),void 0)},f)),f.$container.on("click","[data-role=remove]",a.proxy(function(b){f.$element.attr("disabled")||f.remove(a(b.target).closest(".tag").data("item"))},f)),f.options.itemValue===b.itemValue&&("INPUT"===f.$element[0].tagName?f.add(f.$element.val()):a("option",f.$element).each(function(){f.add(a(this).attr("value"),!0)}))},destroy:function(){var a=this;a.$container.off("keypress","input"),a.$container.off("click","[role=remove]"),a.$container.remove(),a.$element.removeData("tagsinput"),a.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var b=this.$input[0],c=this.$container[0];b&&b.parentNode!==c;)b=b.parentNode;return a(b)}},a.fn.tagsinput=function(b,d,e){var f=[];return this.each(function(){var h,g=a(this).data("tagsinput");g?b||d?void 0!==g[b]&&(h=3===g[b].length&&void 0!==e?g[b](d,null,e):g[b](d),void 0!==h&&f.push(h)):f.push(g):(g=new c(this,b),a(this).data("tagsinput",g),f.push(g),"SELECT"===this.tagName&&a("option",a(this)).attr("selected","selected"),a(this).val(a(this).val()))}),"string"==typeof b?f.length>1?f:f[0]:f},a.fn.tagsinput.Constructor=c,f=a("<div />"),a(function(){a("input[data-role=tagsinput], select[multiple][data-role=tagsinput]").tagsinput()})}(window.jQuery);